"use strict";(self.webpackChunkecomm_client=self.webpackChunkecomm_client||[]).push([[656],{7428:(e,t,l)=>{l.d(t,{c:()=>i});l(9060);var n=l(7360),s=l(2496);const i=function(){return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,s.jsx)(n.CS,{visible:!0,height:"160",width:"160",ariaLabel:"dna-loading",wrapperStyle:{},wrapperClass:"dna-wrapper"})})}},4916:(e,t,l)=>{l.r(t),l.d(t,{default:()=>v});var n=l(9060),s=l(7908),i=l(9867),a=l(3096),r=l(1560),c=l(8088),d=l(316),o=l(8372),u=l(7428),h=l(4320),m=l(2496);const v=function(){var e,t,l,v;const{auth:x,setAuth:p}=(0,i.c)(),{cart:g,setCart:j}=(0,a.c)(),[f,y]=(0,n.useState)(!1),[b,N]=(0,n.useState)(""),[k,C]=(0,n.useState)(!0),[w,S]=(0,n.useState)(""),[P,_]=(0,n.useState)(!1),F=(0,r.i6)();return(0,r.IT)(),(0,n.useEffect)((()=>{y(!0);let e=localStorage.getItem("cart");if(e){let t=JSON.parse(e).map((e=>{var t;if((null===x||void 0===x||null===(t=x.user)||void 0===t?void 0:t.email)===(null===e||void 0===e?void 0:e.userId))return e}));for(let e=0;e<t.length&&t.includes(void 0);e++){let e=t.indexOf(void 0);t.splice(e,1)}void 0===t[0]?j([]):j(t),C(!1)}y(!1)}),[]),(0,n.useEffect)((()=>{!1===k&&function(){if(g){let e=g.map((e=>(e.hasOwnProperty("cartQuantity")||(e.cartQuantity=1),e)));j(e)}}()}),[k]),(0,n.useEffect)((()=>{(async()=>{try{const{data:e}=await o.c.get("/api/v1/product/braintree/token");N(null===e||void 0===e?void 0:e.clientToken)}catch(e){console.log(e)}})()}),[null===x||void 0===x?void 0:x.token]),(0,m.jsx)(s.c,{clName:"bg-primary-subtle",title:"CART Page",children:(0,m.jsx)("div",{className:"container",children:(0,m.jsxs)("div",{className:"row",children:[(0,m.jsxs)("div",{className:"col-md-12",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-center",children:[" ",(0,m.jsx)("h2",{className:"text-center mt-1 bg-light p-2",children:"Hello ".concat((null===x||void 0===x?void 0:x.token)&&(null===x||void 0===x||null===(e=x.user)||void 0===e?void 0:e.name))})]}),(0,m.jsxs)("h4",{className:"text-center",children:[(null===g||void 0===g?void 0:g.length)>1?"You Have ".concat(g.length," items in your cart ").concat(null!==x&&void 0!==x&&x.token?"":"Please Login to Checkout"):"Your Cart is Empty"," ",(0,m.jsx)(c.qVV,{style:{color:"orange"}})]})]}),(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-md-6",children:f?(0,m.jsx)("div",{children:(0,m.jsx)(u.c,{})}):(0,m.jsx)(m.Fragment,{children:g&&(null===g||void 0===g?void 0:g.map((e=>{var t,l;return(0,m.jsxs)("div",{className:"row mb-2 flex-row p-2",style:{border:"2px solid skyblue",borderRadius:"15px",background:"#fffaf2"},children:[(0,m.jsx)("div",{className:"col-md-6 d-flex align-items-center",children:e&&(0,m.jsx)("img",{src:"/api/v1/product/product-photo/".concat(e._id),style:{height:"190px",width:"230px"},alt:"product_image"})}),(0,m.jsxs)("div",{className:"col-md-6 px-5",children:[(0,m.jsx)("h6",{children:e.name}),(0,m.jsxs)("p",{children:[e.description.substring(0,20),"..."]}),(0,m.jsxs)("h6",{children:["Price :$ ",e.price]}),"660c3a703b009992de3e49a4"===(null===e||void 0===e||null===(t=e.category)||void 0===t?void 0:t._id)||"660c3a813b009992de3e49a9"===(null===e||void 0===e||null===(l=e.category)||void 0===l?void 0:l._id)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("h6",{children:["Color: ",e.color]}),(0,m.jsxs)("h6",{children:["Size: ",e.size]})]}):(0,m.jsx)(m.Fragment,{}),(0,m.jsx)("div",{children:(0,m.jsxs)("select",{className:"form-select mt-1 mb-1 w-50",onChange:t=>function(e,t){let l=g.map((l=>l._id===t._id?(l.cartQuantity=+e.target.value,l):l));j(l)}(t,e),value:e.cartQuantity,children:[(0,m.jsx)("option",{value:"1",children:"1"}),(0,m.jsx)("option",{value:"2",children:"2"}),(0,m.jsx)("option",{value:"3",children:"3"}),(0,m.jsx)("option",{value:"4",children:"4"})]})}),(0,m.jsxs)("button",{className:"btn btn-danger cartBtn mt-1",onClick:()=>(e=>{try{let t=[...g],l=t.findIndex((t=>t._id===e));t.splice(l,1),j(t),localStorage.setItem("cart",JSON.stringify(t))}catch(t){console.log(t)}})(e._id),children:["Remove Product"," ",(0,m.jsx)(c.qVV,{style:{color:"#0ffff8"}})]})]})]},e._id)})))})}),(0,m.jsxs)("div",{style:{margin:"0 1rem 1rem 0",marginLeft:"1rem",borderRadius:"1rem",padding:"0",overflow:"hidden"},className:"col-md-5  text-center bg-danger-subtle",children:[(0,m.jsxs)("div",{style:{background:"linear-gradient(to right, #add100, #7b920a)",padding:"3px 10px",color:"white"},children:[(0,m.jsx)("h4",{children:"Cart Summary"}),(0,m.jsx)("p",{children:"Total | Checkout | Payment"}),(0,m.jsx)("hr",{})]}),(0,m.jsxs)("div",{style:{background:"linear-gradient(to right, #ff4e50, #f9d423)",color:"#E0FFFF",height:"100%"},className:"p-3",children:[(0,m.jsxs)("h5",{children:["Total: ",(()=>{try{return g.reduce(((e,t)=>t.price*t.cartQuantity+e),0).toLocaleString("en-US",{style:"currency",currency:"USD"})}catch(e){console.log(e)}})()]}),null!==x&&void 0!==x&&null!==(t=x.user)&&void 0!==t&&t.address?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"mb-3",children:[(0,m.jsx)("h4",{children:"Current Address"}),(0,m.jsx)("h5",{children:null===x||void 0===x||null===(l=x.user)||void 0===l?void 0:l.address}),(0,m.jsx)("button",{className:"btn btn-outline-info text-secondary",onClick:()=>F("/dashboard/user/profile"),children:"Update Address"})]})}):(0,m.jsx)("div",{className:"mb-3",children:null!==x&&void 0!==x&&x.token?(0,m.jsx)("button",{className:"btn-outline-info",onClick:()=>F("/dashboard/user/profile"),children:"Update Address"}):(0,m.jsx)("button",{className:"btn btn-outline-warning",onClick:()=>F("/login",{state:"/cart"}),children:"PLease Login to Checkout"})}),b&&null!==g&&void 0!==g&&g.length?(0,m.jsxs)("div",{className:"mt-2 p-2",children:[(0,m.jsx)(d.c,{options:{authorization:b,paypal:{flow:"vault"}},onInstance:e=>{S(e)}}),(0,m.jsx)("button",{className:"btn btn-primary",onClick:async()=>{try{_(!0);let e=g.reduce(((e,t)=>t.price*t.cartQuantity+e),0);const{nonce:t}=await w.requestPaymentMethod(),{data:l}=await o.c.post("/api/v1/product/braintree/payment",{nonce:t,cart:g,totalCartPrice:e});_(!1),localStorage.removeItem("cart"),j([]),F("/dashboard/user/orders"),h.cp.success("Payment Completed Successfully ")}catch(e){console.log(e),y(!1)}},disabled:P||!w||!(null!==x&&void 0!==x&&null!==(v=x.user)&&void 0!==v&&v.address),children:P?"Processing..":"Make Payment"})]}):null]})]})]})]})})})}}}]);
//# sourceMappingURL=656.c66bd208.chunk.js.map